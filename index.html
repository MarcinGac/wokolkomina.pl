<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Wokół Komina — Komin na niebieskim tle</title>
    <style>
        :root{ --bg-color: #a0d8ef; --komin-left:50%; --komin-bottom:2%; }
        html,body{height:100%;margin:0;font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial;background:var(--bg-color); display:flex;align-items:center;justify-content:center}
        .stage{position:relative;width:min(100vw,1200px);height:min(70vh,720px);max-width:95vw;background:linear-gradient(180deg,#bfefff,#8fcff0);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.15);overflow:hidden}
        .komin{position:absolute;left:var(--komin-left);bottom:var(--komin-bottom);transform:translateX(-50%);width:clamp(60px,6vw,120px);z-index:20;pointer-events:none;transition:transform .08s}
        .komin.dragging{transform:translate(-50%,-50%) scale(1.03);pointer-events:auto}
        .controls{position:fixed;right:14px;bottom:14px;background:rgba(255,255,255,0.95);padding:8px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.08);font-size:13px;z-index:9999}
        .controls button{margin:4px;padding:6px 8px;cursor:pointer}
        @media (prefers-reduced-motion:reduce){.komin{transition:none}}
    </style>
</head>
<body>

<div class="stage" id="stage" role="img" aria-label="Niebieskie tło z kominem">
    <!-- Komin SVG -->
    <svg class="komin" id="komin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-hidden="false" focusable="true">
        <defs>
            <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-opacity="0.25"/>
            </filter>
        </defs>

        <g transform="rotate(-12 100 120)" filter="url(#shadow)">
            <rect x="85" y="70" width="30" height="15" fill="#c62828"/>
            <rect x="85" y="85" width="30" height="15" fill="#ffffff"/>
            <rect x="85" y="100" width="30" height="15" fill="#c62828"/>
            <rect x="85" y="115" width="30" height="15" fill="#ffffff"/>
            <rect x="85" y="130" width="30" height="15" fill="#c62828"/>
            <rect x="85" y="70" width="30" height="90" rx="4" ry="4" fill="none" stroke="#8a1f1f" stroke-width="2"/>
            <rect x="80" y="60" width="40" height="15" rx="3" fill="#8a1f1f"/>
        </g>

        <g class="smoke" aria-hidden="true">
            <circle cx="100" cy="55" r="8" fill="#e0e0e0"/>
            <circle cx="112" cy="45" r="10" fill="#eeeeee"/>
            <circle cx="95"  cy="40" r="6" fill="#f5f5f5"/>
        </g>
    </svg>
</div>

<div class="controls">
    <button id="toggle">Ustaw komin</button>
    <button id="reset">Reset</button>
    <button id="showCss">Pokaż CSS</button>
</div>

<script>
(function(){
    const stage = document.getElementById('stage');
    const komin = document.getElementById('komin');
    const toggle = document.getElementById('toggle');
    const reset = document.getElementById('reset');
    const showCss = document.getElementById('showCss');
    const storageKey = 'wokolkomina-komin-simple-pos';

    function load(){
        try{const s=localStorage.getItem(storageKey);if(s){const p=JSON.parse(s);stage.style.setProperty('--komin-left',p.left);stage.style.setProperty('--komin-bottom',p.bottom);}}catch(e){}
    }
    function save(l,b){localStorage.setItem(storageKey,JSON.stringify({left:l,bottom:b}));}
    function resetPos(){stage.style.setProperty('--komin-left','50%');stage.style.setProperty('--komin-bottom','2%');localStorage.removeItem(storageKey);}    
    load();

    let dragMode=false,dragging=false;
    toggle.addEventListener('click',()=>{dragMode=!dragMode;toggle.textContent=dragMode? 'Wyłącz ustawianie':'Ustaw komin';komin.classList.toggle('dragging',dragMode);komin.style.pointerEvents=dragMode?'auto':'none';});
    reset.addEventListener('click',()=>{resetPos();alert('Pozycja przywrócona');});
    showCss.addEventListener('click',()=>{const l=getComputedStyle(stage).getPropertyValue('--komin-left').trim();const b=getComputedStyle(stage).getPropertyValue('--komin-bottom').trim();prompt('Skopiuj CSS:',`.komin{left:${l};bottom:${b};transform:translateX(-50%);}`);});

    function onPointerDown(e){if(!dragMode) return;dragging=true;try{komin.setPointerCapture(e.pointerId);}catch{} }
    function onPointerMove(e){if(!dragging) return;const rect=stage.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;const clampedX=Math.max(0,Math.min(rect.width,x));const clampedY=Math.max(0,Math.min(rect.height,y));const leftPct=(clampedX/rect.width)*100;const bottomPct=((rect.height-clampedY)/rect.height)*100;stage.style.setProperty('--komin-left',leftPct.toFixed(2)+'%');stage.style.setProperty('--komin-bottom',bottomPct.toFixed(2)+'%');}
    function onPointerUp(e){if(!dragging) return;dragging=false;try{komin.releasePointerCapture(e.pointerId);}catch{}const l=getComputedStyle(stage).getPropertyValue('--komin-left').trim();const b=getComputedStyle(stage).getPropertyValue('--komin-bottom').trim();save(l,b);}    

    komin.addEventListener('pointerdown',onPointerDown);
    window.addEventListener('pointermove',onPointerMove);
    window.addEventListener('pointerup',onPointerUp);
    komin.addEventListener('touchstart',(e)=>e.preventDefault(),{passive:false});
})();
</script>

</body>
</html>